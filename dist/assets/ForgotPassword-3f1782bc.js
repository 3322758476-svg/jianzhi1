import{d as G,r as i,B as z,c as b,a as l,b as s,w as t,I as q,h as J,i as a,k,n as _,t as E,l as V,K as L,T as I,H as O,E as u,_ as Q}from"./index-d856f604.js";const W={class:"forgot-password-container"},X={class:"forgot-password-form"},Y={key:0,class:"step-content"},Z={key:1,class:"step-content"},ee={class:"code-tips"},se={key:2,class:"step-content"},le={class:"back-link"},te={class:"forgot-password-banner"},oe={class:"banner-content"},re={class:"security-tips"},ae={class:"tip-item"},ne={class:"tip-item"},de={class:"tip-item"},ie=G({__name:"ForgotPassword",setup(ue){const N=J(),m=i(1),C=i(!1),F=i(!1),n=i(0),P=i(),x=i(),R=i(),f=z({email:""}),v=z({code:""}),p=z({password:"",confirmPassword:""}),T=(o,e,c)=>{e!==p.password?c(new Error("两次输入的密码不一致")):c()},U={email:[{required:!0,message:"请输入邮箱地址",trigger:"blur"},{type:"email",message:"请输入正确的邮箱地址",trigger:"blur"}]},$={code:[{required:!0,message:"请输入验证码",trigger:"blur"},{min:6,max:6,message:"验证码为6位数字",trigger:"blur"}]},S={password:[{required:!0,message:"请输入新密码",trigger:"blur"},{min:6,message:"密码长度不能少于6位",trigger:"blur"}],confirmPassword:[{required:!0,message:"请确认密码",trigger:"blur"},{validator:T,trigger:"blur"}]},B=async()=>{if(P.value)try{await P.value.validate(),C.value=!0,await new Promise(o=>setTimeout(o,1e3)),u.success(`验证码已发送至 ${f.email}`),m.value=2,D()}catch{u.error("请输入有效的邮箱地址")}finally{C.value=!1}},D=()=>{n.value=60;const o=setInterval(()=>{n.value--,n.value<=0&&clearInterval(o)},1e3)},H=()=>{n.value>0||B()},K=async()=>{if(x.value)try{if(await x.value.validate(),v.code!=="123456"){u.error("验证码错误，请重新输入");return}u.success("验证成功"),m.value=3}catch{u.error("请输入有效的验证码")}},M=async()=>{if(R.value)try{await R.value.validate(),F.value=!0,await new Promise(o=>setTimeout(o,1e3)),u.success("密码重置成功，请使用新密码登录"),N.push("/login")}catch{u.error("密码重置失败，请检查输入")}finally{F.value=!1}};return(o,e)=>{const c=a("el-step"),j=a("el-steps"),g=a("el-input"),d=a("el-form-item"),w=a("el-button"),h=a("el-form"),y=a("el-icon"),A=a("el-link");return k(),b("div",W,[l("div",X,[e[9]||(e[9]=l("div",{class:"form-header"},[l("h2",null,"找回密码"),l("p",null,"请输入您的邮箱地址，我们将发送重置密码的链接")],-1)),s(j,{active:m.value,"align-center":"",class:"steps"},{default:t(()=>[s(c,{title:"验证邮箱",description:"输入注册邮箱"}),s(c,{title:"验证身份",description:"输入验证码"}),s(c,{title:"重置密码",description:"设置新密码"})]),_:1},8,["active"]),m.value===1?(k(),b("div",Y,[s(h,{ref_key:"emailFormRef",ref:P,model:f,rules:U,"label-width":"100px",class:"step-form"},{default:t(()=>[s(d,{label:"邮箱地址",prop:"email"},{default:t(()=>[s(g,{modelValue:f.email,"onUpdate:modelValue":e[0]||(e[0]=r=>f.email=r),placeholder:"请输入注册时使用的邮箱地址",size:"large"},null,8,["modelValue"])]),_:1}),s(d,null,{default:t(()=>[s(w,{type:"primary",size:"large",class:"submit-btn",loading:C.value,onClick:B},{default:t(()=>[...e[5]||(e[5]=[_(" 发送验证码 ",-1)])]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])])):q("",!0),m.value===2?(k(),b("div",Z,[s(h,{ref_key:"codeFormRef",ref:x,model:v,rules:$,"label-width":"100px",class:"step-form"},{default:t(()=>[s(d,{label:"验证码",prop:"code"},{default:t(()=>[s(g,{modelValue:v.code,"onUpdate:modelValue":e[1]||(e[1]=r=>v.code=r),placeholder:"请输入6位验证码",size:"large",maxlength:"6"},null,8,["modelValue"])]),_:1}),l("div",ee,[l("p",null,"验证码已发送至："+E(f.email),1),s(w,{type:"text",disabled:n.value>0,onClick:H},{default:t(()=>[_(E(n.value>0?`${n.value}秒后重发`:"重新发送"),1)]),_:1},8,["disabled"])]),s(d,null,{default:t(()=>[s(w,{type:"primary",size:"large",class:"submit-btn",onClick:K},{default:t(()=>[...e[6]||(e[6]=[_(" 验证 ",-1)])]),_:1})]),_:1})]),_:1},8,["model"])])):q("",!0),m.value===3?(k(),b("div",se,[s(h,{ref_key:"passwordFormRef",ref:R,model:p,rules:S,"label-width":"100px",class:"step-form"},{default:t(()=>[s(d,{label:"新密码",prop:"password"},{default:t(()=>[s(g,{modelValue:p.password,"onUpdate:modelValue":e[2]||(e[2]=r=>p.password=r),type:"password",placeholder:"请输入新密码",size:"large","show-password":""},null,8,["modelValue"])]),_:1}),s(d,{label:"确认密码",prop:"confirmPassword"},{default:t(()=>[s(g,{modelValue:p.confirmPassword,"onUpdate:modelValue":e[3]||(e[3]=r=>p.confirmPassword=r),type:"password",placeholder:"请再次输入新密码",size:"large","show-password":""},null,8,["modelValue"])]),_:1}),s(d,null,{default:t(()=>[s(w,{type:"primary",size:"large",class:"submit-btn",loading:F.value,onClick:M},{default:t(()=>[...e[7]||(e[7]=[_(" 重置密码 ",-1)])]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])])):q("",!0),l("div",le,[s(A,{type:"primary",onClick:e[4]||(e[4]=r=>o.$router.push("/login"))},{default:t(()=>[s(y,null,{default:t(()=>[s(V(L))]),_:1}),e[8]||(e[8]=_(" 返回登录 ",-1))]),_:1})])]),l("div",te,[l("div",oe,[e[13]||(e[13]=l("h3",null,"忘记密码？",-1)),e[14]||(e[14]=l("p",null,"别担心，我们帮您快速找回",-1)),l("div",re,[l("div",ae,[s(y,null,{default:t(()=>[s(V(I))]),_:1}),e[10]||(e[10]=l("div",null,[l("h4",null,"安全验证"),l("p",null,"通过邮箱验证确保账户安全")],-1))]),l("div",ne,[s(y,null,{default:t(()=>[s(V(O))]),_:1}),e[11]||(e[11]=l("div",null,[l("h4",null,"快速重置"),l("p",null,"几分钟内完成密码重置")],-1))]),l("div",de,[s(y,null,{default:t(()=>[s(V(I))]),_:1}),e[12]||(e[12]=l("div",null,[l("h4",null,"安全保障"),l("p",null,"重置链接24小时内有效")],-1))])])])])])}}});const pe=Q(ie,[["__scopeId","data-v-a31bd584"]]);export{pe as default};
