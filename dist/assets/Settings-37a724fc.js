import{d as A,u as J,r as c,B as x,o as L,c as U,b as a,w as r,i as u,k as b,a as v,p as j,l as z,a2 as D,n as m,E as p,_ as I}from"./index-d856f604.js";const O={class:"settings-page"},$=["src"],H={class:"notification-settings"},K={class:"setting-note"},Q=A({__name:"Settings",setup(W){const i=J(),y=c("profile"),_=c(),g=c(),l=x({username:"",email:"",phone:"",avatar:""}),d=x({currentPassword:"",newPassword:"",confirmPassword:""}),P=c(["message","application","system"]),R={username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:2,max:20,message:"用户名长度在 2 到 20 个字符",trigger:"blur"}],email:[{required:!0,message:"请输入邮箱地址",trigger:"blur"},{type:"email",message:"请输入正确的邮箱地址",trigger:"blur"}],phone:[{pattern:/^1[3-9]\d{9}$/,message:"请输入正确的手机号",trigger:"blur"}]},C={currentPassword:[{required:!0,message:"请输入当前密码",trigger:"blur"}],newPassword:[{required:!0,message:"请输入新密码",trigger:"blur"},{min:6,message:"密码长度不能少于6位",trigger:"blur"}],confirmPassword:[{required:!0,message:"请确认新密码",trigger:"blur"},{validator:(s,e,t)=>{e!==d.newPassword?t(new Error("两次输入密码不一致")):t()},trigger:"blur"}]};L(()=>{i.user&&(l.username=i.user.username||"",l.email=i.user.email||"",l.phone=i.user.phone||"",l.avatar=i.user.avatar||"")});const F=s=>{const e=s.type==="image/jpeg"||s.type==="image/png",t=s.size/1024/1024<2;return e?t?!0:(p.error("头像大小不能超过 2MB!"),!1):(p.error("头像只能是 JPG/PNG 格式!"),!1)},h=s=>{const e=new FileReader;e.onload=t=>{var n;l.avatar=(n=t.target)==null?void 0:n.result},e.readAsDataURL(s)},B=async()=>{if(_.value)try{await _.value.validate(),await new Promise(s=>setTimeout(s,1e3)),i.user&&(i.user.username=l.username,i.user.email=l.email,i.user.phone=l.phone,i.user.avatar=l.avatar),p.success("个人信息更新成功")}catch{p.error("保存失败，请检查表单数据")}},S=async()=>{if(g.value)try{await g.value.validate(),await new Promise(s=>setTimeout(s,1e3)),d.currentPassword="",d.newPassword="",d.confirmPassword="",p.success("密码修改成功")}catch{p.error("密码修改失败")}};return(s,e)=>{const t=u("el-input"),n=u("el-form-item"),q=u("el-icon"),N=u("el-upload"),V=u("el-button"),k=u("el-form"),w=u("el-tab-pane"),f=u("el-checkbox"),E=u("el-checkbox-group"),G=u("el-alert"),M=u("el-tabs"),T=u("el-card");return b(),U("div",O,[a(T,{class:"page-card"},{header:r(()=>[...e[8]||(e[8]=[v("h2",null,"账户设置",-1)])]),default:r(()=>[a(M,{modelValue:y.value,"onUpdate:modelValue":e[7]||(e[7]=o=>y.value=o),type:"border-card"},{default:r(()=>[a(w,{label:"基本信息",name:"profile"},{default:r(()=>[a(k,{model:l,"label-width":"100px",rules:R,ref_key:"profileFormRef",ref:_},{default:r(()=>[a(n,{label:"用户名",prop:"username"},{default:r(()=>[a(t,{modelValue:l.username,"onUpdate:modelValue":e[0]||(e[0]=o=>l.username=o),placeholder:"请输入用户名"},null,8,["modelValue"])]),_:1}),a(n,{label:"邮箱",prop:"email"},{default:r(()=>[a(t,{modelValue:l.email,"onUpdate:modelValue":e[1]||(e[1]=o=>l.email=o),placeholder:"请输入邮箱地址"},null,8,["modelValue"])]),_:1}),a(n,{label:"手机号",prop:"phone"},{default:r(()=>[a(t,{modelValue:l.phone,"onUpdate:modelValue":e[2]||(e[2]=o=>l.phone=o),placeholder:"请输入手机号"},null,8,["modelValue"])]),_:1}),a(n,{label:"头像"},{default:r(()=>[a(N,{class:"avatar-uploader",action:"#","show-file-list":!1,"before-upload":F,onChange:h},{default:r(()=>[l.avatar?(b(),U("img",{key:0,src:l.avatar,class:"avatar"},null,8,$)):(b(),j(q,{key:1,class:"avatar-uploader-icon"},{default:r(()=>[a(z(D))]),_:1}))]),_:1})]),_:1}),a(n,null,{default:r(()=>[a(V,{type:"primary",onClick:B},{default:r(()=>[...e[9]||(e[9]=[m("保存修改",-1)])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),a(w,{label:"安全设置",name:"security"},{default:r(()=>[a(k,{model:d,"label-width":"100px",rules:C,ref_key:"securityFormRef",ref:g},{default:r(()=>[a(n,{label:"当前密码",prop:"currentPassword"},{default:r(()=>[a(t,{modelValue:d.currentPassword,"onUpdate:modelValue":e[3]||(e[3]=o=>d.currentPassword=o),type:"password","show-password":""},null,8,["modelValue"])]),_:1}),a(n,{label:"新密码",prop:"newPassword"},{default:r(()=>[a(t,{modelValue:d.newPassword,"onUpdate:modelValue":e[4]||(e[4]=o=>d.newPassword=o),type:"password","show-password":""},null,8,["modelValue"])]),_:1}),a(n,{label:"确认密码",prop:"confirmPassword"},{default:r(()=>[a(t,{modelValue:d.confirmPassword,"onUpdate:modelValue":e[5]||(e[5]=o=>d.confirmPassword=o),type:"password","show-password":""},null,8,["modelValue"])]),_:1}),a(n,null,{default:r(()=>[a(V,{type:"primary",onClick:S},{default:r(()=>[...e[10]||(e[10]=[m("修改密码",-1)])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),a(w,{label:"通知设置",name:"notifications"},{default:r(()=>[v("div",H,[a(E,{modelValue:P.value,"onUpdate:modelValue":e[6]||(e[6]=o=>P.value=o)},{default:r(()=>[a(f,{label:"message",disabled:""},{default:r(()=>[...e[11]||(e[11]=[m("新消息通知",-1)])]),_:1}),a(f,{label:"application",disabled:""},{default:r(()=>[...e[12]||(e[12]=[m("申请状态变更",-1)])]),_:1}),a(f,{label:"system",disabled:""},{default:r(()=>[...e[13]||(e[13]=[m("系统通知",-1)])]),_:1}),a(f,{label:"promotion",disabled:""},{default:r(()=>[...e[14]||(e[14]=[m("推广信息",-1)])]),_:1})]),_:1},8,["modelValue"]),v("div",K,[a(G,{title:"通知功能正在完善中",type:"info",closable:!1})])])]),_:1})]),_:1},8,["modelValue"])]),_:1})])}}});const Y=I(Q,[["__scopeId","data-v-e1601475"]]);export{Y as default};
