# å…¼èŒå¹³å°æ•°æ®åº“éƒ¨ç½²æŒ‡å—

## ğŸ“‹ æ•°æ®åº“æ¦‚è¿°

æœ¬ç³»ç»Ÿä½¿ç”¨ Supabase ä½œä¸ºåç«¯æ•°æ®åº“ï¼ŒåŒ…å«ä»¥ä¸‹æ ¸å¿ƒåŠŸèƒ½æ¨¡å—ï¼š

### ä¸»è¦æ•°æ®è¡¨
- **ç”¨æˆ·è®¤è¯** - åŸºäº Supabase Auth çš„ç”¨æˆ·ç®¡ç†
- **å­¦ç”Ÿä¿¡æ¯** - å­¦ç”Ÿä¸ªäººèµ„æ–™ã€æŠ€èƒ½ã€ç®€å†ç­‰
- **ä¼ä¸šä¿¡æ¯** - ä¼ä¸šèµ„æ–™ã€è®¤è¯çŠ¶æ€ç­‰
- **å…¼èŒå²—ä½** - èŒä½å‘å¸ƒã€ç®¡ç†ã€æœç´¢
- **ç”³è¯·ç®¡ç†** - èŒä½ç”³è¯·ã€çŠ¶æ€è·Ÿè¸ª
- **æ¶ˆæ¯ç³»ç»Ÿ** - å®æ—¶èŠå¤©ã€æ–‡ä»¶ä¼ è¾“
- **é€šçŸ¥ç³»ç»Ÿ** - ç³»ç»Ÿé€šçŸ¥ã€çŠ¶æ€æ›´æ–°
- **è¯„ä»·ç³»ç»Ÿ** - åŒå‘è¯„ä»·æœºåˆ¶

## ğŸš€ å¿«é€Ÿéƒ¨ç½²

### æ–¹æ³•ä¸€ï¼šä½¿ç”¨ Supabase Dashboard

1. **ç™»å½• Supabase æ§åˆ¶å°**
   - è®¿é—®: https://supabase.com/dashboard
   - é€‰æ‹©æˆ–åˆ›å»ºé¡¹ç›®

2. **æ‰§è¡Œ SQL è¿ç§»**
   - è¿›å…¥ SQL Editor
   - æŒ‰é¡ºåºæ‰§è¡Œä»¥ä¸‹æ–‡ä»¶ï¼š
     - `migrations/001_initial_schema.sql`
     - `migrations/003_core_tables.sql`
     - `migrations/004_enhanced_schema.sql`
     - `migrations/005_complete_database.sql`

### æ–¹æ³•äºŒï¼šä½¿ç”¨ Supabase CLI

```bash
# å®‰è£… Supabase CLI
npm install -g supabase

# ç™»å½• Supabase
supabase login

# é“¾æ¥åˆ°é¡¹ç›®
supabase link --project-ref your-project-ref

# éƒ¨ç½²æ•°æ®åº“
supabase db push
```

### æ–¹æ³•ä¸‰ï¼šä½¿ç”¨ SQL æ–‡ä»¶

1. **è¿æ¥æ•°æ®åº“**
   ```bash
   psql postgresql://postgres:[password]@db.[project-ref].supabase.co:5432/postgres
   ```

2. **æ‰§è¡Œéƒ¨ç½²è„šæœ¬**
   ```sql
   \i supabase/deploy_database.sql
   ```

## ğŸ”§ ç¯å¢ƒé…ç½®

### 1. ç¯å¢ƒå˜é‡è®¾ç½®
åœ¨ `.env` æ–‡ä»¶ä¸­é…ç½®ï¼š

```env
VITE_SUPABASE_URL=https://your-project-ref.supabase.co
VITE_SUPABASE_ANON_KEY=your-anon-key
```

### 2. è·å–è¿æ¥ä¿¡æ¯
1. ç™»å½• Supabase Dashboard
2. è¿›å…¥é¡¹ç›®è®¾ç½® â†’ API
3. å¤åˆ¶ URL å’Œ anon key

## ğŸ§ª æ•°æ®åº“æµ‹è¯•

### è¿æ¥æµ‹è¯•
```javascript
// ä½¿ç”¨æµ‹è¯•å·¥å…·
import { testSupabaseConnection } from '@/utils/supabase-test'

// æ‰§è¡Œæµ‹è¯•
testSupabaseConnection()
```

### åŠŸèƒ½æµ‹è¯•
1. **è®¤è¯æµ‹è¯•** - ç”¨æˆ·æ³¨å†Œ/ç™»å½•
2. **æ•°æ®æ“ä½œæµ‹è¯•** - CRUD æ“ä½œéªŒè¯
3. **æƒé™æµ‹è¯•** - RLS ç­–ç•¥éªŒè¯

## ğŸ“Š æ•°æ®åº“ç»“æ„

### æ ¸å¿ƒè¡¨å…³ç³»
```
users (auth.users)
â”œâ”€â”€ students (å­¦ç”Ÿä¿¡æ¯)
â”œâ”€â”€ companies (ä¼ä¸šä¿¡æ¯)
â”‚   â””â”€â”€ jobs (å²—ä½ä¿¡æ¯)
â”‚       â””â”€â”€ applications (ç”³è¯·è®°å½•)
â”œâ”€â”€ messages (æ¶ˆæ¯è®°å½•)
â”œâ”€â”€ notifications (é€šçŸ¥è®°å½•)
â””â”€â”€ reviews (è¯„ä»·è®°å½•)
```

### ç´¢å¼•ä¼˜åŒ–
- æ‰€æœ‰å¤–é”®å­—æ®µéƒ½å»ºç«‹äº†ç´¢å¼•
- å¸¸ç”¨æŸ¥è¯¢å­—æ®µå»ºç«‹äº†å¤åˆç´¢å¼•
- å…¨æ–‡æœç´¢æ”¯æŒ

## ğŸ”’ å®‰å…¨é…ç½®

### è¡Œçº§å®‰å…¨ç­–ç•¥ (RLS)
- **å­¦ç”Ÿè¡¨**: ç”¨æˆ·åªèƒ½è®¿é—®è‡ªå·±çš„æ•°æ®
- **ä¼ä¸šè¡¨**: ç”¨æˆ·åªèƒ½ç®¡ç†è‡ªå·±çš„ä¼ä¸š
- **å²—ä½è¡¨**: å…¬å¼€å¯è¯»ï¼Œä¼ä¸šå¯ç®¡ç†
- **ç”³è¯·è¡¨**: å­¦ç”Ÿå’Œä¼ä¸šåˆ†åˆ«æœ‰ä¸åŒæƒé™

### å­˜å‚¨æ¡¶ç­–ç•¥
- `documents` - ç®€å†ç­‰æ–‡æ¡£å­˜å‚¨
- `images` - å›¾ç‰‡æ–‡ä»¶å­˜å‚¨
- `avatars` - ç”¨æˆ·å¤´åƒå­˜å‚¨
- `logos` - ä¼ä¸šLogoå­˜å‚¨

## ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–

### è§†å›¾å’Œå‡½æ•°
- `job_statistics` - å²—ä½ç»Ÿè®¡è§†å›¾
- `student_statistics` - å­¦ç”Ÿç»Ÿè®¡è§†å›¾
- `search_jobs()` - é«˜çº§æœç´¢å‡½æ•°

### ç›‘æ§æŒ‡æ ‡
- æ¯æ—¥æ´»è·ƒå²—ä½æ•°
- æ¯å‘¨ç”³è¯·æ•°é‡
- æœˆåº¦æ–°ç”¨æˆ·æ•°

## ğŸ› ï¸ ç»´æŠ¤æ“ä½œ

### å¤‡ä»½æ•°æ®åº“
```sql
-- åˆ›å»ºå¤‡ä»½
pg_dump -h db.your-project-ref.supabase.co -U postgres -d postgres > backup.sql

-- æ¢å¤å¤‡ä»½
psql -h db.your-project-ref.supabase.co -U postgres -d postgres < backup.sql
```

### ç›‘æ§æ€§èƒ½
```sql
-- æŸ¥çœ‹è¡¨å¤§å°
SELECT 
    table_name,
    pg_size_pretty(pg_total_relation_size(quote_ident(table_name))) as size
FROM information_schema.tables
WHERE table_schema = 'public';

-- æŸ¥çœ‹ç´¢å¼•ä½¿ç”¨æƒ…å†µ
SELECT 
    indexname,
    tablename,
    idx_scan as scans,
    idx_tup_read as tuples_read,
    idx_tup_fetch as tuples_fetched
FROM pg_stat_user_indexes;
```

## ğŸš¨ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **è¿æ¥å¤±è´¥**
   - æ£€æŸ¥ç¯å¢ƒå˜é‡é…ç½®
   - éªŒè¯ç½‘ç»œè¿æ¥
   - ç¡®è®¤é¡¹ç›®çŠ¶æ€

2. **æƒé™é”™è¯¯**
   - æ£€æŸ¥ RLS ç­–ç•¥
   - éªŒè¯ç”¨æˆ·è§’è‰²
   - æŸ¥çœ‹å®¡è®¡æ—¥å¿—

3. **æ€§èƒ½é—®é¢˜**
   - æ£€æŸ¥ç´¢å¼•ä½¿ç”¨
   - åˆ†ææŸ¥è¯¢è®¡åˆ’
   - ä¼˜åŒ–å¤æ‚æŸ¥è¯¢

### æ—¥å¿—æŸ¥çœ‹
```sql
-- æŸ¥çœ‹æœ€è¿‘é”™è¯¯
SELECT * FROM audit_logs 
WHERE created_at > NOW() - INTERVAL '1 hour'
ORDER BY created_at DESC;
```

## ğŸ“ æ”¯æŒ

- **æ–‡æ¡£**: æŸ¥çœ‹é¡¹ç›®æ–‡æ¡£äº†è§£è¯¦ç»†é…ç½®
- **ç¤¾åŒº**: è®¿é—® Supabase ç¤¾åŒºè·å–å¸®åŠ©
- **ç›‘æ§**: ä½¿ç”¨ Supabase Dashboard ç›‘æ§ç³»ç»ŸçŠ¶æ€

---

**æ³¨æ„**: ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²å‰è¯·åŠ¡å¿…è¿›è¡Œå……åˆ†æµ‹è¯•ï¼